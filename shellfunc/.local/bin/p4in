#!/usr/bin/env bash

set -euo pipefail

if p4 login -s &>/dev/null; then
	exit 1
fi

lockfile=/tmp/p4in.lock
if ! mkdir "$lockfile" &>/dev/null; then
    exit 0
fi
trap "rm -rf '$lockfile'" EXIT TERM INT

p4 login
p4 login -s
